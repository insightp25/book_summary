# AWS 자격증 챌린지 2주차

# 2-1. 2주차 미리보기

### 2주차 목차
- 고가용성/확장성
- load balancer
  - ELB란?
  - CLB
  - ALB
  - NLB
- 데이터 저장 서비스
  - RDS
  - ElastiCache
- AWS의 DNS 알아보기
  - Route 53

---

<br><br><br>

# 2-2. 고가용성과 확장성 알아보기
- 확장성
  - 애플리케이션 또는 시스템이 부하에 맞추어 적절하게 조절될 수 있다.
- 수평적 확장
  - 더 많은 수의 인스턴스를 띄우는 방식의 탄력적인 방식
- 수직적 확장
  - 하드웨어 또는 인스턴스의 티어를 올리고 더 많은 리소스를 사용하는 경우 사용
  - 주로 한 개 애플리케이션이 처리하는 분량이 늘어나는 경우 진행
- 가용성
  - 확장성과 밀접하게 연관되어 있는 개념
  - 서비스를 오래 유지해서 운영하는 것 의미
  - 서비스 가용시간이라는 개념과 밀접한 관계를 갖고 있다.

## 고가용성
- 일반적으로 수평적 확장과 밀접한 연관
- 애플리케이션이 2개 이상의 데이터 센터 또는 가용영역에서 운영되는 것을 의미
- RDS multi-az 등은 자체적으로 지원하고 있다.
  - RDS와 같은 완전 관리형(fully-managed) 서비스는 multi-az를 자체 지원

## EC2에서 적용하기
- 수직적 확장(vertical scaling)
  - t2.micro - t2.large
  - 1vCPU/1.0GiB RAM -> 2vCPU/8.0GiB RAM
  - 인스턴스 타입 변경을 통해 확장을 지원
- 수평적 확장
  - auto scaling group을 multi-az로 적용
    - auto scaling group이 새로운 인스턴스를 생성할 때 기존에 있는 AZ에서 다른 AZ 하나를 생성하게 된다. 그래서 AZ A와 AZ B에 모두 생성이 되었다가 추가로 생성이 될 때 AZ A 그 다음에 B, 그 다음에는 A, 그 다음에는 B 이런 식으로 반복적으로 돌아가면서 하게 된다.
  - 로드밸런서를 multi-az로 적용

## 로드밸런서를 사용하는 이유
- 여러대의 서버에 트래픽을 분산하는 역할
- 여러 application/서버에 대한 외부에 공개된 접근 포인트를 노출시켜주는 역할
  - eg. DNS
- 뒷단의 인스턴스의 장애 또는 부하 핸들링을 용이하게 한다.
- 인스턴스에 대한 헬스 체크를 진행
- 가용영역간의 가용성 지원
- 퍼블릭 트래픽과 프라이빗 트래픽을 분할
  - 인터넷에서 들어오는 요청들을 내부 네트워크 망에서 요청을 분할해주는 역할. '한 번 세탁을 해준다.' 예를 들어 외부에서 공개되어 있는 프론트엔드 서버 혹은 API 서버 등에서는 이런 퍼블릭 트래픽과 프라이빗 트래픽을 분할해주는 LB를 중간에 두고 그걸 기반으로 서비스가 안정적으로 유지되는 가용성을 확보하게 된다.

## 헬스 체크
- 로드 밸런서에서 가장 중요한 역할
- 뒷단의 인스턴스가 들어오는 요청을 받을 수 있는 상태인지 확인하는 역할
- 포트 번호 + 루트로 구성(example.com:443/health-check)
- HTTP 상태 코드를 기준으로 판단
  - 일반적으로 200을 사용
    - eg1. 301, 404 등을 보내준다면 서비스가 실패한 것으로 파악
    - eg2. 201 created -> 정확한 status code를 지정하지 않을 시 실패로 간주할 수도.


---

<br><br><br>

# 2-3. ELB

'AWS에 있는 관리형 load balancer들을 모두 뭉뚱그려서 elastic load balancer라고 부른다.'

## ELB(elastic load balancer)란?
- AWS에서 제공하는 관리형 로드 밸런서
  - '관리형': AWS가 인프라 부문의 매니징을 모두 다 지원해준다. eg. 세부적인 네트워크 설정, 인스턴스 설정, 부하에 따르는 스케일링 같은 것들을 모두 AWS에 위임.
- 관리형이란?
  - AWS가 작동을 보증
  - AWS에서 업그레이드/유지보수/고가용성 관리
  - 적은 수의 설정 변경권한 제공
    - AWS가 모든 내용을 관리해주기 때문에 내부적인 세부 파라미터나 동작 방식들을 변경하는 데 있어서 제한적이라는 의미
- 직접 생성에 비해 비용이 적다.
  - 가격적인 면, 관리 효율 면에서 더 나은 선택
- 다른 AWS service들과 연동 지원(->직접적으로 IP를 등록해주거나 스크립트를 작성하는 등의 일들이 불필요)
  - `cloud watch`를 통해 모니터링하고
  - `AWS certificate manager`를 통해 인증 관리
  - `EC2 auto scaling group`과 연계해 자동으로 부하를 분산하는 등
  - 다양한 서비스 연동 지원

## AWS의 로드 밸런서 살펴보기
- `CLB`(classic load balancer) - 2009년 출시
  - 지원 프로토콜: HTTP, HTTPS, TCP, SSL
  - 더 이상 잘 쓰이지 않는다.
- `ALB`(application load balancer) - 2016
  - 지원 프로토콜: HTTP, HTTPS, web socket
- `NLB`(network load balancer) - 2017
  - 지원 프로토콜: TCP, TLS(보안형 TCP), UDP
- `GWLB`(gateway load balancer)
  - 지원 프로토콜: OSI 3계층 - IP 프로토콜
- 일반적으로 가장 최근 세대의 로드 밸런서를 사용하는 것이 권장된다.

## load balancer와 security groups
- security group을 기반으로 요청에 대한 허용 여부를 핸들링
  - whitelist 기반 - 허용하는 대상만 허용하고 나머지는 모두 다 요청 거부reject
- type | protocol | port 범위 | 요청 소스 를 기반으로 구성
  - "네트워크 보안을 유지한다는 것 - 어디에서 요청하는지를 지정하고 그 요청을 기반으로만 들어올 수 있도록 한다"
- 요청 소스는 요청하는 client를 식별한다.
  - IP 0.0.0.0
  - IP CIDR 10.10.1.0/24
  - 다른 security group의 id
    - '관리의 편의성이라는 부분이 굉장히 중요 -> 다양한 서비스와 요소들을 다루게 되는데, 애플리케이션이 여러 개, 여러 그룹이 될 수록 점점 더 설정을 하나씩 그 때마다 매번 IP를 저장하고 진행을 한다면 어려워진다.'

## CLB(classic load balancer) 훑어보기
- 지원 프로토콜
  - TCP(layer 4)
  - HTTP, HTTPS(layer 7)
- HTTP/TCP 기준으로 헬스 체크를 진행
- 고정된 호스트 네임



---

<br><br><br>

# 2-4. ALB 알아보기







---

<br><br><br>

# 2-5. NLB와 GWLB 알아보기







---

<br><br><br>

# 2-6. AWS 로드 밸런서 추가 기능 알아보기







---

<br><br><br>

# 2-7. ALB 사용 실습







---

<br><br><br>

# 2-8. Auto Scaling Group 사용 실습







---

<br><br><br>

# 2-9. AWS RDS 알아보기







---

<br><br><br>

# 2-10. AWS Aurora 알아보기










