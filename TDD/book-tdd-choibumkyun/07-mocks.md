# 7. 대역

# 대역의 필요성

외부 요인은 테스트 작성을 어렵게 만들며 테스트 결과도 예측할 수 없게 만든다.

eg. 카드 정보 검사 대행업체에서 테스트시 사용하라고 제공한 카드의번호의 유효기간이 한 달 뒤일 수 있다. 이 경우 테스트는 한 달 뒤 유효기간 만료로 실패하게 된다. 또는 비슷하게 테스트 용도의 도난 카드 정보를 외부 업체에서 삭제하면 도용 관련 테스트가 실패하게 된다.

이렇게 테스트 대상에서 의존하는 요인 때문에 테스트가 어려울 시 대역을 써서 테스트를 진행할 수 있다.

> 영어로 된 테스트 관련 글에서 test double이란 표현이 자주 나오는데 여기서 double은 대역에 해당한다. 즉, test double은 테스트에서 진짜 대신 사용할 대역을 의미한다.  
대역의 종류는 스텁, 가짜, 스파이, 모의 객체가 존재하는데 각 대역 종류마다 쓰임새가 다르다.


<br><br>

# 대역의 종류

|대역 종류|설명|
|---|---|
|스텁(Stub)|구현을 단순한 것으로 대체. 테스트에 맞게 단순히 원하는 동작을 수행한다. StubCardNumberValidator가 스텁 대역에 해당한다.|
|가짜(Fake)|제품에는 적합하지 않지만, 실제 동작하는 구현을 제공한다(eg. DB 대신 메모리를 이용해서 구현한 repository)|
|스파이(Spy)|호출된 내역을 기록한다. 기록한 내용은 테스트 결과를 검증할 때 사용한다. 스텁이기도 하다.|
|모의(Mock)|기대한 대로 상호작용하는지 행위를 검증한다. 기대한 대로 동작하지 않으면 익셉션을 발생할 수 있다. 모의 객체는 스텁이자 스파이도 된다.|

> 구현 전에 설계해 보기: 개발은 진행하는 동안 요구사항이 계속해서 바뀐다. 그럼에도 단위 기능 구현에 앞서 어떤 구성 요소가 필요할지 고민하는 것은 의존 대상을 도출할 때 도움이 된다. 물론 사전 설계 그대로 만들어지지는 않는다. 구현하다 보면 설계한 것과 다른 의존 대상이 출현하기도, 필요할 거라 생각했던 의존 대상이 사라지기도 한다.




<br><br>

## 약한 암호 확인 기능에 스텁 사용








<br><br>

##





<br><br>

##






<br><br>

##





<br><br>

##






<br><br>

##





<br><br>

##






<br><br>

##



